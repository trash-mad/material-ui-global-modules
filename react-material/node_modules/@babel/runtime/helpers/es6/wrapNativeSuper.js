"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = _wrapNativeSuper;

var _create = require("../../core-js/object/create");

var _create2 = _interopRequireDefault(_create);

var _map = require("../../core-js/map");

var _map2 = _interopRequireDefault(_map);

var _construct2 = require("../../core-js/reflect/construct");

var _construct3 = _interopRequireDefault(_construct2);

var _typeof2 = require("../../helpers/es6/typeof");

var _typeof3 = _interopRequireDefault(_typeof2);

var _setPrototypeOf = require("../../core-js/object/set-prototype-of");

var _setPrototypeOf2 = _interopRequireDefault(_setPrototypeOf);

var _getPrototypeOf = require("../../core-js/object/get-prototype-of");

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _gPO(o) {
  _gPO = _getPrototypeOf2.default || function _gPO(o) {
    return o.__proto__;
  };

  return _gPO(o);
}

function _sPO(o, p) {
  _sPO = _setPrototypeOf2.default || function _sPO(o, p) {
    o.__proto__ = p;
    return o;
  };

  return _sPO(o, p);
}

function _construct(Parent, args, Class) {
  _construct = (typeof Reflect === "undefined" ? "undefined" : (0, _typeof3.default)(Reflect)) === "object" && _construct3.default || function _construct(Parent, args, Class) {
    var Constructor,
        a = [null];
    a.push.apply(a, args);
    Constructor = Parent.bind.apply(Parent, a);
    return _sPO(new Constructor(), Class.prototype);
  };

  return _construct(Parent, args, Class);
}

function _wrapNativeSuper(Class) {
  var _cache = typeof _map2.default === "function" ? new _map2.default() : undefined;

  exports.default = _wrapNativeSuper = function _wrapNativeSuper(Class) {
    if (typeof Class !== "function") {
      throw new TypeError("Super expression must either be null or a function");
    }

    if (typeof _cache !== "undefined") {
      if (_cache.has(Class)) return _cache.get(Class);

      _cache.set(Class, Wrapper);
    }

    function Wrapper() {}

    Wrapper.prototype = (0, _create2.default)(Class.prototype, {
      constructor: {
        value: Wrapper,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
    return _sPO(Wrapper, _sPO(function Super() {
      return _construct(Class, arguments, _gPO(this).constructor);
    }, Class));
  };

  return _wrapNativeSuper(Class);
}